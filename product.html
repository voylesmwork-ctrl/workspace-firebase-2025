<html>
  <head>
    <link rel="stylesheet" type="text/css" href="css/styles.css" />
    <title>Product Page</title>
    <!-- Jquery library   ---->
    <script
      src="https://code.jquery.com/jquery-3.5.1.js"
      integrity="sha256-QWo7LDvxbWT2tbbQ97B53yJnYU3WhH/C8ycbRAkjPDc="
      crossorigin="anonymous"
    ></script>
  </head>

  <body>

        <!-- Popular Items Section -->
        <div id="popular-section">
            <h2>Popular Favorites</h2>
            <!-- Carousel Container -->
            <div class="carousel-container">
                <button class="carousel-btn prev" onclick="scrollCarousel('popular-carousel', -1)">&#8249;</button>
                <div class="carousel" id="popular-carousel">
                    <!-- Each menu item in the carousel -->
                    <div class="menu-item">
                        <img src="img/hotLatte.png" alt="Latte" class="menu-image">
                        <h3>Latte</h3>
                        <p>Smooth espresso combined with steamed milk. (<span>5</span>)</p>
                        <p>$4.00</p>
                        
                        <button>Add to Order</button>
                    </div>
                    <div class="menu-item">
                        <img src="img/matchaLatte.png" alt="Matcha Latte" class="menu-image">
                        <h3>Matcha Latte</h3>
                        <p>Earthy matcha blended with steamed milk. (<span>9</span>)</p>
                        <p>$4.50</p>
                        <button>Add to Order</button>
                    </div>
                    <div class="menu-item">
                        <img src="img/cookies.png" alt="Cookies" class="menu-image">
                        <h3>Chocolate Chip Cookie</h3>
                        <p>Golden cookie with milk chocolate chips. (<span>10</span>)</p>
                        <p>$2.75</p>
                        <button>Add to Order</button>
                    </div>
                    <div class="menu-item">
                        <img src="img/bagel.png" alt="bagel" class="menu-image">
                        <h3>Bagel Sandwich</h3>
                        <p>Crispy everything bagel with cream cheese and veggies. (<span>12</span>)</p>
                        <p>$5.00</p>
                        <button>Add to Order</button>
                    </div>
                    <div class="menu-item">
                        <img src="img/chocMuffin.png" alt="muffin" class="menu-image">
                        <h3>Double Chocolate Muffin</h3>
                        <p>Warm melty chocolate muffin with dark chocolate center. (<span>10</span>)</p>
                        <p>$3.00</p>
                        <button>Add to Order</button>
                    </div>
                </div>
                
                <button class="carousel-btn next" >&#8250;</button>
            </div>
        </div>

    <!-- Insert this script at the bottom of the HTML, but before you use any Firebase services -->
    <script type="module">
      import { initializeApp } from 'https://www.gstatic.com/firebasejs/12.5.0/firebase-app.js';
      // Add Firebase products that you want to use
      import { getAuth } from 'https://www.gstatic.com/firebasejs/12.5.0/firebase-auth.js';
      import { getFirestore, collection, addDoc, doc, getDocs, updateDoc, query, deleteDoc, onSnapshot } from 'https://www.gstatic.com/firebasejs/12.5.0/firebase-firestore.js';

      /* Change the configuration */

      const firebaseConfig = {
        apiKey: 'AIzaSyDob-9txBBuYpCCsYbDdab7OiJHrb3L5d0',
        authDomain: 'database2025-1a422.firebaseapp.com',
        projectId: 'database2025-1a422',
        storageBucket: 'database2025-1a422.firebasestorage.app',
        messagingSenderId: '162500439428',
        appId: '1:162500439428:web:a87724d9a8842f249a81d1',
      };
      // Initialize Firebase
      const app = initializeApp(firebaseConfig);
      const db = getFirestore(app);
      const inventoryColl = collection(db, 'inventory');

      const itemnames = document.querySelectorAll('.menu-item h3');
      const itemquants = document.querySelectorAll('.menu-item p span');
      const buttons = document.querySelectorAll('.menu-item button');

      onSnapshot(inventoryColl, (snapshot) => {
        snapshot.forEach((doc) => {
          const data = doc.data();
          for (var i in itemnames) {
            var name = itemnames[i].textContent;
            if (data[name] !== undefined) {
              var quan = data[name];
              itemquants[i].textContent = "" + quan;
            }
          }
        });
      });

      const handleevent = (e) => {
        var itemname = e.target.parentElement.querySelector('h3').textContent;
        var itemquant = parseInt(e.target.parentElement.querySelector('p span').textContent) - 1;
        updateDoc(doc(inventoryColl, 'inventoryList'), {[itemname]: itemquant});
      };

      buttons.forEach((button, index) => {
        button.addEventListener('click', handleevent);
      });
    </script>
  </body>
</html>